<!-- üìÅ templates/admin/products/import_form.html -->
<!-- üìä –§–æ—Ä–º–∞ –∏–º–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ -->
<!-- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->

{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}–ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel{% endblock %}

{% block extrahead %}
{{ block.super }}
<style>
.import-container {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.file-info {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 5px;
    margin: 15px 0;
}

.excel-structure {
    background: #e3f2fd;
    padding: 15px;
    border-radius: 5px;
    margin: 15px 0;
}

.btn-upload {
    background: #007cba;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
}

.btn-upload:hover {
    background: #005a87;
}

.error-message {
    background: #ffebee;
    color: #c62828;
    padding: 10px;
    border-radius: 5px;
    margin: 10px 0;
}

.success-message {
    background: #e8f5e8;
    color: #2e7d2e;
    padding: 10px;
    border-radius: 5px;
    margin: 10px 0;
}
</style>
{% endblock %}

{% block content %}
<div class="import-container">
    <h1>üìä –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel</h1>
    
    <!-- üìã –°–æ–æ–±—â–µ–Ω–∏—è Django -->
    {% if messages %}
        {% for message in messages %}
            <div class="{% if message.tags == 'error' %}error-message{% else %}success-message{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    
    <!-- üìù –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã -->
    <div class="file-info">
        <h3>üéØ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ–∞–π–ª—É:</h3>
        <ul>
            <li>üìÅ –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞: Excel (.xlsx –∏–ª–∏ .xls)</li>
            <li>üìè –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10 –ú–ë</li>
            <li>üìã –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: –ö–æ–¥ —Ç–æ–≤–∞—Ä–∞, –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</li>
            <li>üî¢ –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏</li>
        </ul>
    </div>
    
    <!-- üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞ -->
    <div class="excel-structure">
        <h3>üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞:</h3>
        <p><strong>üéØ –í —Å—Ç–æ–ª–±—Ü–µ A —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –î–í–ê —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö:</strong></p>
        
        <h4>üìÇ –°—Ç—Ä–æ–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (—Å —Ç–æ—á–∫–æ–π):</h4>
        <table border="1" style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
            <thead>
                <tr style="background: #4caf50; color: white;">
                    <th>A</th>
                    <th>B</th>
                    <th>C</th>
                    <th>D</th>
                    <th>E</th>
                    <th>F</th>
                    <th>G</th>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</strong></td>
                    <td><strong>–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong></td>
                    <td><strong>Title –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong></td>
                    <td><strong>‚Äî</strong></td>
                    <td><strong>–û–ø–∏—Å–∞–Ω–∏–µ</strong></td>
                    <td><strong>Meta-–æ–ø–∏—Å–∞–Ω–∏–µ</strong></td>
                    <td><strong>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</strong></td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="background: #c8e6c9;"><strong>1.BMW</strong></td>
                    <td>–ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ BMW</td>
                    <td>BMW –∫–æ–≤—Ä–∏–∫–∏</td>
                    <td style="color: #999;">–ü–£–°–¢–ê–Ø</td>
                    <td>–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...</td>
                    <td>SEO –æ–ø–∏—Å–∞–Ω–∏–µ BMW...</td>
                    <td>bmw_category.jpg</td>
                </tr>
            </tbody>
        </table>
        
        <h4>üõçÔ∏è –°—Ç—Ä–æ–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–±–µ–∑ —Ç–æ—á–∫–∏):</h4>
        <table border="1" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #2196f3; color: white;">
                    <th>A</th>
                    <th>B</th>
                    <th>C</th>
                    <th>D</th>
                    <th>E</th>
                    <th>F</th>
                    <th>G</th>
                </tr>
                <tr style="background: #e3f2fd;">
                    <td><strong>SKU —Ç–æ–≤–∞—Ä–∞</strong></td>
                    <td><strong>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</strong></td>
                    <td><strong>Title —Ç–æ–≤–∞—Ä–∞</strong></td>
                    <td><strong>–¶–µ–Ω–∞</strong></td>
                    <td><strong>–û–ø–∏—Å–∞–Ω–∏–µ</strong></td>
                    <td><strong>Meta-–æ–ø–∏—Å–∞–Ω–∏–µ</strong></td>
                    <td><strong>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</strong></td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="background: #bbdefb;"><strong>10001</strong></td>
                    <td>–ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ EVA –¥–ª—è BMW 1</td>
                    <td>–ö–æ–≤—Ä–∏–∫–∏ BMW 1</td>
                    <td>85.00</td>
                    <td>–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–≤—Ä–∏–∫–∏...</td>
                    <td>SEO –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞...</td>
                    <td>bmw1.jpg</td>
                </tr>
                <tr>
                    <td style="background: #bbdefb;"><strong>10002</strong></td>
                    <td>–ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ EVA –¥–ª—è BMW 3</td>
                    <td>–ö–æ–≤—Ä–∏–∫–∏ BMW 3</td>
                    <td style="color: #999;">–ü–£–°–¢–ê–Ø</td>
                    <td>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞...</td>
                    <td>Meta –æ–ø–∏—Å–∞–Ω–∏–µ...</td>
                    <td>bmw3.jpg</td>
                </tr>
            </tbody>
        </table>
        
        <p><strong>üí° –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞:</strong></p>
        <ul>
            <li>üîç <strong>–°–∏—Å—Ç–µ–º–∞ —á–∏—Ç–∞–µ—Ç –ø–æ—Å—Ç—Ä–æ—á–Ω–æ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑</strong></li>
            <li>üìÇ <strong>–°—Ç—Ä–æ–∫–∞ —Å —Ç–æ—á–∫–æ–π –≤ A</strong> (1.BMW, 2.Acura) ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è <strong>–∫–∞—Ç–µ–≥–æ—Ä–∏—è BMW, Acura</strong></li>
            <li>üõçÔ∏è <strong>–°—Ç—Ä–æ–∫–∞ –±–µ–∑ —Ç–æ—á–∫–∏ –≤ A</strong> (10001, 10002) ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è <strong>—Ç–æ–≤–∞—Ä –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong></li>
            <li>üí∞ <strong>–¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π</strong> (–±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ 0.00)</li>
            <li>üì∑ <strong>–£ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ù–ï–¢ —Ü–µ–Ω—ã</strong>, —É —Ç–æ–≤–∞—Ä–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å</li>
        </ul>
        
        <div style="background: #fff3cd; padding: 10px; border-radius: 5px; margin-top: 10px;">
            <strong>üéØ –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–∞:</strong>
            <pre style="margin: 5px 0;">
1.BMW      | –ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ BMW           | BMW –∫–æ–≤—Ä–∏–∫–∏    | (–ø—É—Å—Ç–∞—è) | ...  ‚Üê –ö–ê–¢–ï–ì–û–†–ò–Ø
10001      | –ö–æ–≤—Ä–∏–∫–∏ BMW 1 —Å–µ—Ä–∏–∏       | BMW 1          | 85.00    | ...  ‚Üê –¢–û–í–ê–† (–∫–∞—Ç–µ–≥–æ—Ä–∏—è BMW)
10002      | –ö–æ–≤—Ä–∏–∫–∏ BMW 3 —Å–µ—Ä–∏–∏       | BMW 3          | 90.00    | ...  ‚Üê –¢–û–í–ê–† (–∫–∞—Ç–µ–≥–æ—Ä–∏—è BMW)
2.Acura    | –ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ Acura         | Acura –∫–æ–≤—Ä–∏–∫–∏  | (–ø—É—Å—Ç–∞—è) | ...  ‚Üê –ö–ê–¢–ï–ì–û–†–ò–Ø  
20001      | –ö–æ–≤—Ä–∏–∫–∏ Acura MDX         | Acura MDX      | 95.00    | ...  ‚Üê –¢–û–í–ê–† (–∫–∞—Ç–µ–≥–æ—Ä–∏—è Acura)
            </pre>
        </div>
    </div>
    
    <!-- üìù –§–æ—Ä–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <form method="post" enctype="multipart/form-data" id="upload-form">
        {% csrf_token %}
        
        <div style="margin: 20px 0;">
            <label for="{{ form.excel_file.id_for_label }}" style="display: block; font-weight: bold; margin-bottom: 10px;">
                üìä –í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª:
            </label>
            
            {{ form.excel_file }}
            
            {% if form.excel_file.errors %}
                <div class="error-message">
                    {% for error in form.excel_file.errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}
            
            <p style="color: #666; font-size: 14px; margin-top: 5px;">
                {{ form.excel_file.help_text }}
            </p>
        </div>
        
        <div style="margin: 20px 0;">
            <button type="submit" class="btn-upload">
                üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª
            </button>
        </div>
    </form>
    
    <!-- üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="file-info">
        <h3>üîÑ –ü—Ä–æ—Ü–µ—Å—Å –∏–º–ø–æ—Ä—Ç–∞:</h3>
        <ol>
            <li><strong>üì§ –ó–∞–≥—Ä—É–∑–∫–∞:</strong> –í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª –∏ –Ω–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å"</li>
            <li><strong>üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</strong> –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –æ–±—Ä–∞–∑—Ü—ã –¥–∞–Ω–Ω—ã—Ö</li>
            <li><strong>‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:</strong> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∏–º–ø–æ—Ä—Ç, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã</li>
            <li><strong>üöÄ –ò–º–ø–æ—Ä—Ç:</strong> –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã/–æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</li>
            <li><strong>üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</strong> –ü–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ–± –∏–º–ø–æ—Ä—Ç–µ</li>
        </ol>
    </div>
    
    <!-- üîô –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div style="margin-top: 30px; text-align: center;">
        <a href="{% url 'admin:products_product_changelist' %}" style="color: #007cba; text-decoration: none;">
            ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É —Ç–æ–≤–∞—Ä–æ–≤
        </a>
    </div>
</div>

<script>
// üì± –ü—Ä–æ—Å—Ç–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞
document.getElementById('upload-form').addEventListener('submit', function(e) {
    const fileInput = document.getElementById('{{ form.excel_file.id_for_label }}');
    const file = fileInput.files[0];
    
    if (!file) {
        alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏');
        e.preventDefault();
        return;
    }
    
    // üìè –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (10 –ú–ë)
    if (file.size > 10 * 1024 * 1024) {
        alert('‚ùå –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º—É–º: 10 –ú–ë');
        e.preventDefault();
        return;
    }
    
    // üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
    const allowedExtensions = ['.xlsx', '.xls'];
    const fileName = file.name.toLowerCase();
    const isValidExtension = allowedExtensions.some(ext => fileName.endsWith(ext));
    
    if (!isValidExtension) {
        alert('‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ .xlsx –∏–ª–∏ .xls');
        e.preventDefault();
        return;
    }
    
    // ‚úÖ –í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    const button = document.querySelector('.btn-upload');
    button.textContent = 'üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...';
    button.disabled = true;
});
</script>
{% endblock %}