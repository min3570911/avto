<!-- üìÅ templates/admin/products/import_form.html -->
<!-- üìä –§–æ—Ä–º–∞ –∏–º–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ -->
<!-- ‚úÖ –û–ë–ù–û–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ZIP –∞—Ä—Ö–∏–≤–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ -->

{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}–ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel{% endblock %}

{% block extrahead %}
{{ block.super }}
<style>
.import-container {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.file-info {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 5px;
    margin: 15px 0;
}

/* üÜï –°—Ç–∏–ª—å –¥–ª—è –±–ª–æ–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π */
.images-info {
    background: #fff3e0;
    padding: 15px;
    border-radius: 5px;
    margin: 15px 0;
    border-left: 4px solid #ff9800;
}

.excel-structure {
    background: #e3f2fd;
    padding: 15px;
    border-radius: 5px;
    margin: 15px 0;
}

.btn-upload {
    background: #007cba;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
}

.btn-upload:hover {
    background: #005a87;
}

.error-message {
    background: #ffebee;
    color: #c62828;
    padding: 10px;
    border-radius: 5px;
    margin: 10px 0;
}

.success-message {
    background: #e8f5e8;
    color: #2e7d2e;
    padding: 10px;
    border-radius: 5px;
    margin: 10px 0;
}

/* üÜï –°—Ç–∏–ª—å –¥–ª—è –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã */
.form-field {
    margin: 20px 0;
}

.form-field label {
    display: block;
    font-weight: bold;
    margin-bottom: 10px;
}

.form-field input[type="file"] {
    width: 100%;
    padding: 8px;
    border: 2px dashed #ddd;
    border-radius: 5px;
    background: #fafafa;
    transition: border-color 0.3s;
}

.form-field input[type="file"]:hover {
    border-color: #007cba;
}

.form-help-text {
    color: #666;
    font-size: 14px;
    margin-top: 5px;
}
</style>
{% endblock %}

{% block content %}
<div class="import-container">
    <h1>üìä –ò–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Excel</h1>
    
    <!-- üìã –°–æ–æ–±—â–µ–Ω–∏—è Django -->
    {% if messages %}
        {% for message in messages %}
            <div class="{% if message.tags == 'error' %}error-message{% else %}success-message{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    
    <!-- üìù –û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã -->
    <div class="file-info">
        <h3>üéØ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ Excel —Ñ–∞–π–ª—É:</h3>
        <ul>
            <li>üìÅ –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞: Excel (.xlsx –∏–ª–∏ .xls)</li>
            <li>üìè –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10 –ú–ë</li>
            <li>üìã –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏: –ö–æ–¥ —Ç–æ–≤–∞—Ä–∞, –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</li>
            <li>üî¢ –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏</li>
        </ul>
    </div>

    <!-- üÜï –ù–û–í–´–ô –ë–õ–û–ö: –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º -->
    <div class="images-info">
        <h3>üñºÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</h3>
        <ul>
            <li>üìÅ –§–æ—Ä–º–∞—Ç –∞—Ä—Ö–∏–≤–∞: ZIP (.zip)</li>
            <li>üìè –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∞—Ä—Ö–∏–≤–∞: 10 –ú–ë</li>
            <li>üñºÔ∏è –§–æ—Ä–º–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: JPG, JPEG, PNG, WEBP</li>
            <li>üìä –ú–∞–∫—Å–∏–º—É–º —Ñ–∞–π–ª–æ–≤ –≤ –∞—Ä—Ö–∏–≤–µ: 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</li>
            <li>üìù –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–Ω—ã <strong>—Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å</strong> —Å –∫–æ–ª–æ–Ω–∫–æ–π "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" –≤ Excel</li>
            <li>üìÇ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–∞–ø–∫–∞–º:
                <ul style="margin-top: 5px;">
                    <li>üè∑Ô∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π ‚Üí <code>media/categories/</code></li>
                    <li>üì¶ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ ‚Üí <code>media/product/</code></li>
                </ul>
            </li>
            <li>üîÑ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω—ã</li>
        </ul>
    </div>
    
    <!-- üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞ -->
    <div class="excel-structure">
        <h3>üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞:</h3>
        <p><strong>üéØ –í —Å—Ç–æ–ª–±—Ü–µ A —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –î–í–ê —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö:</strong></p>
        
        <h4>üìÇ –°—Ç—Ä–æ–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (—Å —Ç–æ—á–∫–æ–π):</h4>
        <table border="1" style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
            <thead>
                <tr style="background: #4caf50; color: white;">
                    <th>A</th>
                    <th>B</th>
                    <th>C</th>
                    <th>D</th>
                    <th>E</th>
                    <th>F</th>
                    <th>G</th>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</strong></td>
                    <td><strong>–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong></td>
                    <td><strong>Title –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong></td>
                    <td><strong>‚Äî</strong></td>
                    <td><strong>–û–ø–∏—Å–∞–Ω–∏–µ</strong></td>
                    <td><strong>Meta-–æ–ø–∏—Å–∞–Ω–∏–µ</strong></td>
                    <td><strong>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</strong></td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="background: #c8e6c9;"><strong>1.BMW</strong></td>
                    <td>–ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ BMW</td>
                    <td>BMW –∫–æ–≤—Ä–∏–∫–∏</td>
                    <td style="color: #999;">–ü–£–°–¢–ê–Ø</td>
                    <td>–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...</td>
                    <td>SEO –æ–ø–∏—Å–∞–Ω–∏–µ BMW...</td>
                    <td><strong>bmw_category.jpg</strong></td>
                </tr>
            </tbody>
        </table>
        
        <h4>üõçÔ∏è –°—Ç—Ä–æ–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–±–µ–∑ —Ç–æ—á–∫–∏):</h4>
        <table border="1" style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #2196f3; color: white;">
                    <th>A</th>
                    <th>B</th>
                    <th>C</th>
                    <th>D</th>
                    <th>E</th>
                    <th>F</th>
                    <th>G</th>
                </tr>
                <tr style="background: #e3f2fd;">
                    <td><strong>SKU —Ç–æ–≤–∞—Ä–∞</strong></td>
                    <td><strong>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</strong></td>
                    <td><strong>Title —Ç–æ–≤–∞—Ä–∞</strong></td>
                    <td><strong>–¶–µ–Ω–∞</strong></td>
                    <td><strong>–û–ø–∏—Å–∞–Ω–∏–µ</strong></td>
                    <td><strong>Meta-–æ–ø–∏—Å–∞–Ω–∏–µ</strong></td>
                    <td><strong>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</strong></td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="background: #bbdefb;"><strong>10001</strong></td>
                    <td>–ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ EVA –¥–ª—è BMW 1</td>
                    <td>–ö–æ–≤—Ä–∏–∫–∏ BMW 1</td>
                    <td>85.00</td>
                    <td>–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–≤—Ä–∏–∫–∏...</td>
                    <td>SEO –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞...</td>
                    <td><strong>bmw1.jpg</strong></td>
                </tr>
                <tr>
                    <td style="background: #bbdefb;"><strong>10002</strong></td>
                    <td>–ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ EVA –¥–ª—è BMW 3</td>
                    <td>–ö–æ–≤—Ä–∏–∫–∏ BMW 3</td>
                    <td style="color: #999;">–ü–£–°–¢–ê–Ø</td>
                    <td>–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞...</td>
                    <td>Meta –æ–ø–∏—Å–∞–Ω–∏–µ...</td>
                    <td><strong>bmw3.jpg</strong></td>
                </tr>
            </tbody>
        </table>
        
        <p><strong>üí° –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞:</strong></p>
        <ul>
            <li>üîç <strong>–°–∏—Å—Ç–µ–º–∞ —á–∏—Ç–∞–µ—Ç –ø–æ—Å—Ç—Ä–æ—á–Ω–æ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑</strong></li>
            <li>üìÇ <strong>–°—Ç—Ä–æ–∫–∞ —Å —Ç–æ—á–∫–æ–π –≤ A</strong> (1.BMW, 2.Acura) ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è <strong>–∫–∞—Ç–µ–≥–æ—Ä–∏—è BMW, Acura</strong></li>
            <li>üõçÔ∏è <strong>–°—Ç—Ä–æ–∫–∞ –±–µ–∑ —Ç–æ—á–∫–∏ –≤ A</strong> (10001, 10002) ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è <strong>—Ç–æ–≤–∞—Ä –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong></li>
            <li>üí∞ <strong>–¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π</strong> (–±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ 0.00)</li>
            <li>üì∑ <strong>–£ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ù–ï–¢ —Ü–µ–Ω—ã</strong>, —É —Ç–æ–≤–∞—Ä–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å</li>
            <li>üñºÔ∏è <strong>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–≤—è–∑—ã–≤–∞—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∞–º —Ñ–∞–π–ª–æ–≤</strong> –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ G</li>
        </ul>
        
        <div style="background: #fff3cd; padding: 10px; border-radius: 5px; margin-top: 10px;">
            <strong>üéØ –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–∞–π–ª–∞:</strong>
            <pre style="margin: 5px 0;">
1.BMW      | –ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ BMW           | BMW –∫–æ–≤—Ä–∏–∫–∏    | (–ø—É—Å—Ç–∞—è) | ... | bmw.jpg        ‚Üê –ö–ê–¢–ï–ì–û–†–ò–Ø
10001      | –ö–æ–≤—Ä–∏–∫–∏ BMW 1 —Å–µ—Ä–∏–∏       | BMW 1          | 85.00    | ... | bmw1.jpg       ‚Üê –¢–û–í–ê–† (–∫–∞—Ç–µ–≥–æ—Ä–∏—è BMW)
10002      | –ö–æ–≤—Ä–∏–∫–∏ BMW 3 —Å–µ—Ä–∏–∏       | BMW 3          | 90.00    | ... | bmw3.jpg       ‚Üê –¢–û–í–ê–† (–∫–∞—Ç–µ–≥–æ—Ä–∏—è BMW)
2.Acura    | –ê–≤—Ç–æ–∫–æ–≤—Ä–∏–∫–∏ Acura         | Acura –∫–æ–≤—Ä–∏–∫–∏  | (–ø—É—Å—Ç–∞—è) | ... | acura.jpg      ‚Üê –ö–ê–¢–ï–ì–û–†–ò–Ø  
20001      | –ö–æ–≤—Ä–∏–∫–∏ Acura MDX         | Acura MDX      | 95.00    | ... | acura_mdx.jpg  ‚Üê –¢–û–í–ê–† (–∫–∞—Ç–µ–≥–æ—Ä–∏—è Acura)
            </pre>
        </div>
    </div>
    
    <!-- üìù –§–æ—Ä–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <form method="post" enctype="multipart/form-data" id="upload-form">
        {% csrf_token %}
        
        <!-- üìä Excel —Ñ–∞–π–ª -->
        <div class="form-field">
            <label for="{{ form.excel_file.id_for_label }}">
                üìä –í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª:
            </label>
            
            {{ form.excel_file }}
            
            {% if form.excel_file.errors %}
                <div class="error-message">
                    {% for error in form.excel_file.errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}
            
            <p class="form-help-text">
                {{ form.excel_file.help_text }}
            </p>
        </div>

        <!-- üÜï –ù–û–í–û–ï –ü–û–õ–ï: ZIP –∞—Ä—Ö–∏–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ -->
        <div class="form-field">
            <label for="images_zip">
                üñºÔ∏è ZIP –∞—Ä—Ö–∏–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
            </label>
            
            <input type="file" 
                   id="images_zip" 
                   name="images_zip" 
                   accept=".zip"
                   style="padding: 8px; border: 2px dashed #ddd; border-radius: 5px; background: #fafafa; width: 100%;">
            
            <p class="form-help-text">
                üìÅ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: ZIP (–º–∞–∫—Å. 10 –ú–ë, –¥–æ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
            </p>
        </div>
        
        <div style="margin: 30px 0;">
            <button type="submit" class="btn-upload">
                üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã
            </button>
        </div>
    </form>
    
    <!-- üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="file-info">
        <h3>üîÑ –ü—Ä–æ—Ü–µ—Å—Å –∏–º–ø–æ—Ä—Ç–∞:</h3>
        <ol>
            <li><strong>üì§ –ó–∞–≥—Ä—É–∑–∫–∞:</strong> –í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª –∏ ZIP –∞—Ä—Ö–∏–≤ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ), –Ω–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å"</li>
            <li><strong>üñºÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:</strong> –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å–ø–∞–∫—É–µ—Ç ZIP –∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –ø–∞–ø–∫–∞–º</li>
            <li><strong>üëÅÔ∏è –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä:</strong> –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –æ–±—Ä–∞–∑—Ü—ã –¥–∞–Ω–Ω—ã—Ö</li>
            <li><strong>‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:</strong> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∏–º–ø–æ—Ä—Ç, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã</li>
            <li><strong>üöÄ –ò–º–ø–æ—Ä—Ç:</strong> –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã/–æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</li>
            <li><strong>üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</strong> –ü–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ–± –∏–º–ø–æ—Ä—Ç–µ</li>
        </ol>

        <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin-top: 15px;">
            <strong>üí° –°–æ–≤–µ—Ç:</strong> –ú–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ Excel —Ñ–∞–π–ª –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, 
            –∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∏–º–ø–æ—Ä—Ç —Å ZIP –∞—Ä—Ö–∏–≤–æ–º.
        </div>
    </div>
    
    <!-- üîô –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div style="margin-top: 30px; text-align: center;">
        <a href="{% url 'admin:products_product_changelist' %}" style="color: #007cba; text-decoration: none;">
            ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É —Ç–æ–≤–∞—Ä–æ–≤
        </a>
    </div>
</div>

<script>
// üì± –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞
document.getElementById('upload-form').addEventListener('submit', function(e) {
    const fileInput = document.getElementById('{{ form.excel_file.id_for_label }}');
    const zipInput = document.getElementById('images_zip');
    
    const excelFile = fileInput.files[0];
    const zipFile = zipInput.files[0];
    
    // ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ Excel —Ñ–∞–π–ª–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
    if (!excelFile) {
        alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏');
        e.preventDefault();
        return;
    }
    
    // üìè –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ Excel —Ñ–∞–π–ª–∞ (10 –ú–ë)
    if (excelFile.size > 10 * 1024 * 1024) {
        alert('‚ùå Excel —Ñ–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º—É–º: 10 –ú–ë');
        e.preventDefault();
        return;
    }
    
    // üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è Excel —Ñ–∞–π–ª–∞
    const allowedExcelExtensions = ['.xlsx', '.xls'];
    const excelFileName = excelFile.name.toLowerCase();
    const isValidExcelExtension = allowedExcelExtensions.some(ext => excelFileName.endsWith(ext));
    
    if (!isValidExcelExtension) {
        alert('‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç Excel —Ñ–∞–π–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ .xlsx –∏–ª–∏ .xls');
        e.preventDefault();
        return;
    }

    // üÜï –ù–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê: ZIP —Ñ–∞–π–ª (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π)
    if (zipFile) {
        // üìè –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ ZIP —Ñ–∞–π–ª–∞ (10 –ú–ë)
        if (zipFile.size > 10 * 1024 * 1024) {
            alert('‚ùå ZIP –∞—Ä—Ö–∏–≤ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º—É–º: 10 –ú–ë');
            e.preventDefault();
            return;
        }
        
        // üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è ZIP —Ñ–∞–π–ª–∞
        if (!zipFile.name.toLowerCase().endsWith('.zip')) {
            alert('‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç –∞—Ä—Ö–∏–≤–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ .zip');
            e.preventDefault();
            return;
        }
        
        console.log('‚úÖ ZIP —Ñ–∞–π–ª –ø—Ä–æ—à–µ–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é:', zipFile.name, '—Ä–∞–∑–º–µ—Ä:', (zipFile.size / 1024 / 1024).toFixed(2) + ' –ú–ë');
    }
    
    // ‚úÖ –í—Å—ë –≤ –ø–æ—Ä—è–¥–∫–µ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    const button = document.querySelector('.btn-upload');
    const originalText = button.textContent;
    
    if (zipFile) {
        button.textContent = 'üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ Excel –∏ ZIP —Ñ–∞–π–ª–æ–≤...';
    } else {
        button.textContent = 'üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ Excel —Ñ–∞–π–ª–∞...';
    }
    
    button.disabled = true;
    
    // üÜï –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const form = document.getElementById('upload-form');
    form.style.opacity = '0.7';
    form.style.pointerEvents = 'none';
});

// üÜï –í–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ñ–∞–π–ª–æ–≤
document.getElementById('images_zip').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const helpText = this.nextElementSibling;
    
    if (file) {
        const sizeText = (file.size / 1024 / 1024).toFixed(2) + ' –ú–ë';
        helpText.innerHTML = `üìÅ –í—ã–±—Ä–∞–Ω: <strong>${file.name}</strong> (${sizeText})`;
        helpText.style.color = '#2e7d2e';
    } else {
        helpText.innerHTML = 'üìÅ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: ZIP (–º–∞–∫—Å. 10 –ú–ë, –¥–æ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)';
        helpText.style.color = '#666';
    }
});
</script>
{% endblock %}