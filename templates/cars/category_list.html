{% extends 'base/base.html' %}
{% load static %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<section class="section-pagetop bg-blue">
    <div class="container">
        <h2 class="title-page">üöó –ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ –∫–æ–≤—Ä–∏–∫–∏</h2>
        <nav>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url 'index' %}">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="breadcrumb-item active" aria-current="page">–ê–≤—Ç–æ–º–æ–±–∏–ª–∏</li>
            </ol>
        </nav>
    </div>
</section>

<section class="section-content padding-y">
    <div class="container">

        <!-- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π -->
        <div class="row mb-4">
            <div class="col-md-6">
                <h3>–í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É –∞–≤—Ç–æ–º–æ–±–∏–ª—è</h3>
                <p>–£ –Ω–∞—Å –≤ –Ω–∞–ª–∏—á–∏–∏ {{ total_products }} –≤–∏–¥–æ–≤ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã—Ö –∫–æ–≤—Ä–∏–∫–æ–≤</p>
            </div>
            <div class="col-md-6 text-md-right">
                <span class="badge badge-primary">üöó –†–∞–∑–¥–µ–ª: –ê–≤—Ç–æ–º–æ–±–∏–ª–∏</span>
                <a href="{% url 'cars:configurator' %}" class="btn btn-outline-primary btn-sm ml-2">
                    üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä –∫–æ–≤—Ä–∏–∫–æ–≤
                </a>
            </div>
        </div>

        <!-- üöó –°–µ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π -->
        <div class="row">
            {% for category in categories %}
            <div class="col-md-6 col-lg-4 col-xl-3 mb-4">
                <div class="category-card h-100">
                    <a href="{% url 'cars:product_list_by_category' category.slug %}" class="text-decoration-none">
                        <div class="category-image">
                            {% if category.category_image %}
                                <img src="{{ category.category_image.url }}" alt="{{ category.category_name }}" class="img-fluid">
                            {% else %}
                                <img src="{% static 'images/placeholder-category.png' %}" alt="{{ category.category_name }}" class="img-fluid">
                            {% endif %}
                        </div>
                        <div class="category-info p-3">
                            <h5 class="category-title">{{ category.category_name }}</h5>
                            <p class="text-muted small">
                                {% if category.products.count %}
                                    {{ category.products.count }} —Ç–æ–≤–∞—Ä{{ category.products.count|pluralize:",,–æ–≤" }}
                                {% else %}
                                    –°–∫–æ—Ä–æ –≤ –Ω–∞–ª–∏—á–∏–∏
                                {% endif %}
                            </p>
                        </div>
                    </a>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center py-5">
                <h3>üöó –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</h3>
                <p>–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Ä–∞–∑–¥–µ–ª –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.</p>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å <a href="{% url 'boats:category_list' %}">–ª–æ–¥–æ—á–Ω—ã–µ –∫–æ–≤—Ä–∏–∫–∏</a></p>
                <a href="{% url 'index' %}" class="btn btn-primary mt-3">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
            </div>
            {% endfor %}
        </div>

        <!-- üÜï –ù–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã -->
        {% if newest_products %}
        <section class="newest-products mt-5">
            <h3 class="mb-4">üÜï –ù–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–µ –∫–æ–≤—Ä–∏–∫–∏</h3>
            <div class="row">
                {% for product in newest_products %}
                <div class="col-md-6 col-lg-4 col-xl-2 mb-4">
                    <div class="card product-card h-100">
                        <a href="{% url 'cars:product_detail' product.slug %}">
                            {% if product.main_image %}
                                <img src="{{ product.main_image.url }}" class="card-img-top" alt="{{ product.product_name }}">
                            {% else %}
                                <img src="{% static 'images/placeholder-product.png' %}" class="card-img-top" alt="{{ product.product_name }}">
                            {% endif %}
                        </a>
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">
                                <a href="{% url 'cars:product_detail' product.slug %}">{{ product.product_name }}</a>
                            </h6>
                            <div class="mt-auto">
                                <div class="price-box">
                                    {{ product.get_display_price }} —Ä—É–±.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
        {% endif %}

        <!-- üîß –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–ª–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π -->
        <section class="configurator-promo mt-5">
            <div class="row">
                <div class="col-12">
                    <div class="alert alert-info">
                        <h5>üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä –∫–æ–≤—Ä–∏–∫–æ–≤</h5>
                        <p>–°–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –∫–æ–≤—Ä–∏–∫–æ–≤ –¥–ª—è –≤–∞—à–µ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è! –í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç–∞, –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—é –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏.</p>
                        <a href="{% url 'cars:configurator' %}" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä—É</a>
                    </div>
                </div>
            </div>
        </section>

    </div>
</section>

<style>
.category-card {
    background: white;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    overflow: hidden;
}

.category-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.category-image {
    height: 150px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f9fa;
}

.category-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.category-title {
    color: #333;
    font-weight: 600;
    margin-bottom: 10px;
}

.product-card {
    transition: transform 0.2s ease;
}

.product-card:hover {
    transform: translateY(-2px);
}

.product-card img {
    height: 180px;
    object-fit: cover;
}

.price-box {
    font-weight: bold;
    color: #007bff;
    font-size: 1.1em;
}

.configurator-promo {
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    padding: 20px;
    border-radius: 10px;
}
</style>
{% endblock %}